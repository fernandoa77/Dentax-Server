{% extends "base.html" %}

{% block title %}Registros{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Registros</h1>
    <div class="mb-4">
        <a href="{% url 'agregar_registro' %}" class="btn btn-primary mb-2">Agregar Nuevo Registro</a>
        <input type="text" id="searchInput" onkeyup="filterTable()" class="form-control"
            placeholder="Buscar registros...">
    </div>
    <div style="overflow-y: auto; max-height: 400px;">
        <table class="table table-striped table-bordered" id="registrosTable">
            <thead class="thead-dark">
                <tr>
                    <th>Acciones</th>
                    <th>Folio</th>
                    <th>Doctor</th>
                    <th>Paciente</th>
                    <th>Descuento</th>
                    <th>Subtotal</th>
                    <th>Total</th>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Teléfono</th>
                    <th>Edad</th>
                    <th>Meses</th>
                    <th>Sv1</th>
                    <th>Qt1</th>
                    <th>Nt1</th>
                    <th>Pr1</th>
                    <th>Sv2</th>
                    <th>Qt2</th>
                    <th>Nt2</th>
                    <th>Pr2</th>
                    <th>Sv3</th>
                    <th>Qt3</th>
                    <th>Nt3</th>
                    <th>Pr3</th>
                    <th>Sv4</th>
                    <th>Qt4</th>
                    <th>Nt4</th>
                    <th>Pr4</th>
                    <th>Sv5</th>
                    <th>Qt5</th>
                    <th>Nt5</th>
                    <th>Pr5</th>
                    <th>Comisión</th>
                    <th>ID Doctor</th>
                    <th>Tiempo de Espera</th>
                    <th>Tomas</th>
                </tr>
            </thead>
            <tbody>
                {% for registro in registros_pacientes %}
                <tr>
                    <td>
                        <a href="{% url 'editar_registro' registro.folio %}" class="btn btn-sm btn-warning">Editar</a>
                        <a href="{% url 'eliminar_registro' registro.folio %}"
                            class="btn btn-sm btn-danger">Eliminar</a>
                    </td>
                    <td>{{ registro.folio }}</td>
                    <td>{{ registro.doctor }}</td>
                    <td>{{ registro.paciente }}</td>
                    <td>{{ registro.descuento }}</td>
                    <td>{{ registro.subtotal }}</td>
                    <td>{{ registro.total }}</td>
                    <td>{{ registro.fecha }}</td>
                    <td>{{ registro.hora }}</td>
                    <td>{{ registro.telefono }}</td>
                    <td>{{ registro.edad }}</td>
                    <td>{{ registro.meses }}</td>
                    <td>{{ registro.sv1 }}</td>
                    <td>{{ registro.qt1 }}</td>
                    <td>{{ registro.nt1 }}</td>
                    <td>{{ registro.pr1 }}</td>
                    <td>{{ registro.sv2 }}</td>
                    <td>{{ registro.qt2 }}</td>
                    <td>{{ registro.nt2 }}</td>
                    <td>{{ registro.pr2 }}</td>
                    <td>{{ registro.sv3 }}</td>
                    <td>{{ registro.qt3 }}</td>
                    <td>{{ registro.nt3 }}</td>
                    <td>{{ registro.pr3 }}</td>
                    <td>{{ registro.sv4 }}</td>
                    <td>{{ registro.qt4 }}</td>
                    <td>{{ registro.nt4 }}</td>
                    <td>{{ registro.pr4 }}</td>
                    <td>{{ registro.sv5 }}</td>
                    <td>{{ registro.qt5 }}</td>
                    <td>{{ registro.nt5 }}</td>
                    <td>{{ registro.pr5 }}</td>
                    <td>{{ registro.comision }}</td>
                    <td>{{ registro.id_doctor }}</td>
                    <td>{{ registro.tiempo_espera }}</td>
                    <td>{{ registro.tomas }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
    function filterTable() {
        var input, filter, table, tr, td, i, j, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("registrosTable");
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            tr[i].style.display = "none";
            td = tr[i].getElementsByTagName("td");
            for (j = 0; j < td.length; j++) {
                if (td[j]) {
                    txtValue = td[j].textContent || td[j].innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                        break;
                    }
                }
            }
        }
    }
</script>
{% endblock %}